<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel - Quiz App</title>
    <style>
        body {
            background-color: black;
            color: yellow;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 { color: cyan; }
        input, select, button {
            margin: 5px;
            padding: 10px;
            border-radius: 5px;
        }
        .question-list {
            margin-top: 20px;
            background: #111;
            padding: 10px;
            border-radius: 8px;
        }
        .question-item {
            border: 1px solid yellow;
            padding: 10px;
            margin: 5px;
            border-radius: 5px;
            text-align: left;
        }
        .edit-btn, .delete-btn {
            margin: 5px;
            padding: 5px 10px;
            border: none;
            cursor: pointer;
            border-radius: 5px;
        }
        .edit-btn { background-color: orange; color: white; }
        .delete-btn { background-color: red; color: white; }
    </style>
</head>
<body>
    <h1>âš¡ Admin Panel</h1>

    <h3>Add / Update Question</h3>
    <select id="subject">
        <option value="Math">Math</option>
        <option value="Science">Science</option>
        <option value="English">English</option>
    </select><br>
    <input type="text" id="question" placeholder="Enter Question"><br>
    <input type="text" id="options" placeholder="Options (comma separated)"><br>
    <input type="text" id="answer" placeholder="Correct Answer"><br>
    <button id="addQuestionBtn">Add Question</button>
    <button id="updateQuestionBtn" style="display:none;">Update Question</button>

    <h3>Questions List</h3>
    <div id="questionsList" class="question-list"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import { getDatabase, ref, push, get, set, remove } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD0KSh__yrwZYDOKU85ltV-zOBpF6gLvm0",
            authDomain: "quizapp-f1224.firebaseapp.com",
            databaseURL: "https://quizapp-f1224-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "quizapp-f1224",
            storageBucket: "quizapp-f1224.firebasestorage.app",
            messagingSenderId: "432922180972",
            appId: "1:432922180972:web:e816869f5efc03f32f4749"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        const subjectEl = document.getElementById("subject");
        const questionEl = document.getElementById("question");
        const optionsEl = document.getElementById("options");
        const answerEl = document.getElementById("answer");
        const questionsList = document.getElementById("questionsList");

        let editKey = null;

        async function loadQuestions() {
            questionsList.innerHTML = "";
            const subject = subjectEl.value;
            const snapshot = await get(ref(db, "questions/" + subject));

            if (snapshot.exists()) {
                const data = snapshot.val();
                for (const key in data) {
                    const q = data[key];
                    const div = document.createElement("div");
                    div.className = "question-item";
                    div.innerHTML = `
                        <p><b>Q:</b> ${q.question}</p>
                        <p><b>Options:</b> ${q.options.join(", ")}</p>
                        <p><b>Answer:</b> ${q.answer}</p>
                        <button class="edit-btn" onclick="editQuestion('${subject}','${key}','${q.question}','${q.options}','${q.answer}')">Edit</button>
                        <button class="delete-btn" onclick="deleteQuestion('${subject}','${key}')">Delete</button>
                    `;
                    questionsList.appendChild(div);
                }
            } else {
                questionsList.innerHTML = "<p>No questions available</p>";
            }
        }

        window.editQuestion = (subject, key, question, options, answer) => {
            subjectEl.value = subject;
            questionEl.value = question;
            optionsEl.value = options;
            answerEl.value = answer;
            editKey = key;
            document.getElementById("addQuestionBtn").style.display = "none";
            document.getElementById("updateQuestionBtn").style.display = "inline-block";
        };

        window.deleteQuestion = async (subject, key) => {
            if (confirm("Are you sure you want to delete this question?")) {
                await remove(ref(db, `questions/${subject}/${key}`));
                loadQuestions();
            }
        };

        document.getElementById("addQuestionBtn").onclick = async () => {
            const subject = subjectEl.value;
            const question = questionEl.value;
            const options = optionsEl.value.split(",");
            const answer = answerEl.value;

            if (question && options.length && answer) {
                await push(ref(db, "questions/" + subject), { question, options, answer });
                questionEl.value = "";
                optionsEl.value = "";
                answerEl.value = "";
                loadQuestions();
            }
        };

        document.getElementById("updateQuestionBtn").onclick = async () => {
            if (editKey) {
                const subject = subjectEl.value;
                await set(ref(db, `questions/${subject}/${editKey}`), {
                    question: questionEl.value,
                    options: optionsEl.value.split(","),
                    answer: answerEl.value
                });
                editKey = null;
                document.getElementById("addQuestionBtn").style.display = "inline-block";
                document.getElementById("updateQuestionBtn").style.display = "none";
                questionEl.value = "";
                optionsEl.value = "";
                answerEl.value = "";
                loadQuestions();
            }
        };

        subjectEl.addEventListener("change", loadQuestions);
        loadQuestions();
    </script>
</body>
</html>
